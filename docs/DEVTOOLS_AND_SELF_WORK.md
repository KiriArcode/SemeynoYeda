# Инструкция по DevTools и самостоятельная подготовка к правкам

Документ входит в план по меню и модалкам. Здесь: как правильно определять элементы для правок в DevTools и что сделать самостоятельно для более точных инструкций.

---

## 1. Инструкция по работе в DevTools для определения правок

### 1.1 Как понять, по какому элементу вы кликаете

- Откройте приложение в браузере (Chrome/Edge).
- **Правый клик** по кнопке или области → **«Просмотреть код»** (Inspect). Откроется вкладка **Elements**, курсор попадёт на соответствующий узел в DOM.
- Либо в DevTools (F12) нажмите иконку **выбора элемента** (Ctrl+Shift+C), затем кликните по кнопке на странице — в Elements подсветится именно тот узел, который получает клик.

**Важно:** если подсвечивается не кнопка, а родитель (например, строка приёма пищи или заголовок аккордеона), значит клик «попадает» в него — тогда обработчик кнопки не вызывается. Нужно либо кликать строго по кнопке, либо править разметку/размеры.

### 1.2 Как найти кнопку в коде по разметке

1. В **Elements** выделен нужный элемент (кнопка).
2. Обратите внимание на:
   - **Текст внутри:** например «Заменить блюдо» в `title` или `aria-label`.
   - **Уникальный класс** (часть строки классов), например `rounded-[8px]`, или иконка по соседству — `ArrowLeftRight`.
3. В редакторе (Cursor/VS Code) **поиск по проекту** (Ctrl+Shift+F / Cmd+Shift+F) по этому тексту или по имени компонента/иконки — так находите файл и компонент, где кнопка рендерится.

### 1.3 Как проверить, кто перехватывает клик

- В **Elements** выберите кнопку (или родителя, который подсвечивается при клике).
- Справа откройте панель **Event Listeners** (или внизу вкладку).
- Разверните **click** — увидите список обработчиков: на каком элементе и в какой фазе (capture/bubble) они висят. Если обработчик висит на родителе и вызывается раньше, он может перехватывать или мешать обработчику кнопки.

### 1.4 Как проверить доступность и имя элемента (для стабильной идентификации)

- В **Elements** выберите элемент.
- Справа вкладка **Accessibility** (или в **Computed** блок Accessibility).
- Смотрите **Name** — откуда берётся имя: `aria-label`, `title`, текст внутри.
- Для кнопок без видимого текста (только иконка) лучше задать `aria-label`, например: «Заменить блюдо» — тогда это имя можно использовать в инструкциях и тестах.

### 1.5 Как не опираться на «пятую кнопку» (XPath / порядок)

- Селекторы вида `div[4]/button[5]` привязаны к структуре страницы. Добавили блок или фильтр — номера сместились.
- Надёжнее:
  - искать по **тексту** или **aria-label** в коде;
  - при необходимости добавить **data-testid** (например `data-testid="meal-slot-swap"`) и в инструкциях ссылаться на него.

### 1.6 Краткий чек-лист перед правкой UI

- [ ] В DevTools убедиться, что клик попадает именно в нужную кнопку/элемент (Inspect при клике).
- [ ] Найти этот элемент в коде по тексту/классу/компоненту.
- [ ] Проверить Event Listeners у кнопки и её родителей — нет ли перехвата клика.
- [ ] При необходимости добавить `aria-label` или `data-testid` для однозначной идентификации.

---

## 2. Что сделать самостоятельно для более точных инструкций

Чтобы давать и получать более точные инструкции по правкам (и по плану меню/модалок), полезно сделать следующее.

### 2.1 Изучить ключевые файлы кода

- **Страница меню:** [src/pages/MenuPage.tsx](src/pages/MenuPage.tsx) — структура страницы, фильтры, карточки дней, вызов `MealSlot` и `handleMealSlotUpdate`.
- **Слот приёма и кнопка swap:** [src/components/menu/MealSlot.tsx](src/components/menu/MealSlot.tsx) — аккордеон, список рецептов, кнопка замены, вызов SwapModal.
- **Модалка замены:** [src/components/menu/SwapModal.tsx](src/components/menu/SwapModal.tsx) — содержимое модалки выбора рецепта.
- **Базовый Modal:** [src/components/ui/Modal.tsx](src/components/ui/Modal.tsx) — портал в `body`, z-index, закрытие.
- **Схема данных:** [src/data/schema.ts](src/data/schema.ts) — `WeekMenu`, `MenuDay`, `MealSlot`, `Recipe`.
- **Генерация шаблона меню:** [src/data/seedMenu.ts](src/data/seedMenu.ts) — как устроена неделя и приёмы.

После просмотра проще формулировать: «кнопка в MealSlot рядом с иконкой ArrowLeftRight» или «состояние swap в MenuPage».

### 2.2 Создать личный глоссарий

В одном файле (например в личных заметках или в `docs/MY_GLOSSARY.md`) кратко зафиксировать:

- Названия компонентов и экранов: MenuPage, MealSlot, SwapModal, WeekOverview, MealType, forWhom.
- Где что лежит: «текущее меню» — `dataService.menus.getCurrent()», «состав дня» — `weekMenu.days[].meals[]».
- Термины проекта: Wabba, seed-меню, приём (meal), слот (slot), weekStart.

Так вы и ассистент будете одинаково понимать формулировки типа «открыть модалку замены в слоте обеда понедельника».

### 2.3 Сделать карточки в NotebookLM по структуре и архитектуре

- Загрузить в NotebookLM или в отдельный «дайджест»:
  - [ARCHITECTURE.md](../ARCHITECTURE.md) и/или [docs/ARCHITECTURE_ANALYSIS.md](ARCHITECTURE_ANALYSIS.md);
  - [RECIPE_STRUCTURE.md](RECIPE_STRUCTURE.md), [schema.ts](../src/data/schema.ts) (или выдержки);
  - [MODAL_ARCHITECTURE_FIX.md](MODAL_ARCHITECTURE_FIX.md) и этот файл.
- Сформировать карточки/вопросы по темам:
  - Структура приложения: роуты, провайдеры, где хранится меню.
  - Структура данных: WeekMenu, дни, приёмы, рецепты в слоте.
  - Почему модалка не открывается и как её вынести на уровень страницы.

Так при следующих запросах можно опираться на «как в карточках по архитектуре» и получать более согласованные с проектом ответы.

### 2.4 Чек-лист самостоятельной подготовки

- [ ] Просмотреть перечисленные файлы кода (п. 2.1).
- [ ] Завести личный глоссарий (п. 2.2) и пополнять по мере работы.
- [ ] Создать в NotebookLM карточки по структуре и архитектуре (п. 2.3).
- [ ] При следующей правке сначала пройти чек-лист DevTools (раздел 1) и при необходимости указать в запросе: элемент по aria-label/data-testid или по цитате из кода.

---

Этот документ можно использовать как часть плана: сначала выполнить раздел 2 (подготовка), затем при правках следовать разделу 1 (DevTools) и ссылаться на [MODAL_ARCHITECTURE_FIX.md](MODAL_ARCHITECTURE_FIX.md) и план генерации/редактирования меню.
